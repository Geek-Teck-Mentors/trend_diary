name: PBIタイプ設定

on:
  issues:
    types: [opened]

env:
  GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
  VIEW_ID: '1'
  PROJECT_NUMBER: "1"
  FIELD_TYPE: "163048810"
  PBI_VALUE: "PBI"

jobs:
  set-pbi-type:
    runs-on: ubuntu-latest
    steps:
      - name: Check View ID
        if: ${{ env.VIEW_ID == '1' }}
        run: |
          gh api graphql -f query='
            mutation($project:ID!, $item:ID!) {
              updateProjectV2ItemFieldValue(input: {
                projectId: $project
                itemId: $item
                fieldId: "${{ env.FIELD_TYPE }}"
                value: "${{ env.PBI_VALUE }}"
              }) {
                projectV2Item { id }
              }
            }'
