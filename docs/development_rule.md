## 開発ルール

### 基本方針

- 仕様はテストコードに記載する（コードを書かずともテストケース名は記載する）
- リファクタリング時は必ずlint、format、testコマンドを実行する
- 必ず日本語を使用する
- 敬語は使用しない
- `.claude/skills`にCommit、TDDの設定を入れている。必要に応じて参照すること

### レビュー時のprefix

レビューコメントには以下のprefixをつける:

- `[must]` - 必ず変更が必要
- `[imo]` - 個人的な意見、修正必須ではない（in my opinion）
- `[nits]` - ささいな指摘（nitpick）
- `[ask]` - 質問
- `[fyi]` - 参考情報

### 重要な規約

**インポート**: `src/`ルートからの絶対インポートを使用（TypeScript path mapping: `@/*`）

**バリデーション**:
- データ検証にドメイン層のZodスキーマを使用
- 全てのAPI層エンドポイントで`zodValidator`の使用が必須
  - `query`: クエリパラメータのバリデーション
  - `param`: パスパラメータのバリデーション
  - `json`: リクエストボディのバリデーション
- バリデーション失敗時は自動的に422ステータスで返却
- `ZodValidatedContext`系の型を使用してハンドラー関数で型安全にデータアクセス
- **バリデーション順序**: authenticator → zodValidator(param) → zodValidator(json) → handler

**その他**:
- utilsの作成は禁止
  - 理由: 責任の所在が不明確になり、アーキテクチャ層の境界が曖昧になる。DDDの原則を遵守し、貧血性ドメインを防ぐため
  - 代替案:
    - 共通ロジックは`src/common/`配下の明確な目的を持ったディレクトリに配置
    - ドメイン固有のロジックは各集約内に配置
- Pinoロガーで構造化ログを使用

